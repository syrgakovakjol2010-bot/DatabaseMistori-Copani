<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>S.A.B. BOSS EDITION v11.0</title>
    <style>
        /* --- –ì–õ–û–ë–ê–õ–¨–ù–´–ï –°–¢–ò–õ–ò --- */
        :root {
            --bg: #000000;
            --card: #0d0d0d;
            --border: #222222;
            --accent: #ffffff;
            --gold: #ffd700;
            --green: #00ff66;
            --red: #ff3333;
            --blue: #0088ff;
            --purple: #bf00ff;
        }

        body {
            background: var(--bg);
            color: #fff;
            font-family: 'Inter', -apple-system, sans-serif;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
            overflow-x: hidden;
        }

        /* --- –°–ö–ï–õ–ï–¢ –ò–ù–¢–ï–†–§–ï–ô–°–ê --- */
        #app { display: none; min-height: 100vh; flex-direction: column; }
        .content { padding: 20px; flex: 1; padding-bottom: 100px; }
        
        /* –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è */
        .auth-container { 
            display: flex; flex-direction: column; align-items: center; justify-content: center; 
            min-height: 100vh; padding: 25px; box-sizing: border-box; 
        }
        .auth-card { 
            width: 100%; max-width: 360px; border: 1px solid var(--border); 
            padding: 40px; background: var(--card); border-radius: 16px; text-align: center; 
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        }

        input, select, textarea { 
            width: 100%; padding: 15px; margin: 12px 0; background: #151515; 
            border: 1px solid #333; color: #fff; border-radius: 10px; 
            font-size: 16px; box-sizing: border-box; transition: 0.3s;
        }
        input:focus { border-color: var(--accent); outline: none; }

        button { 
            width: 100%; padding: 15px; border-radius: 10px; font-weight: 800; 
            border: none; cursor: pointer; text-transform: uppercase; 
            transition: 0.2s; font-size: 14px; letter-spacing: 1px;
        }
        .btn-main { background: var(--accent); color: #000; }
        .btn-sec { background: transparent; color: #666; border: 1px solid #333; margin-top: 15px; }

        /* –®–∞–ø–∫–∞ */
        .header { 
            padding: 15px 20px; border-bottom: 1px solid var(--border); 
            display: flex; justify-content: space-between; align-items: center; 
            background: rgba(0,0,0,0.8); backdrop-filter: blur(10px); 
            position: sticky; top: 0; z-index: 100;
        }

        /* –î–∞—à–±–æ—Ä–¥ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ */
        .analytics { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 25px; }
        .ana-card { 
            background: var(--card); border: 1px solid var(--border); 
            padding: 15px; border-radius: 12px; position: relative; overflow: hidden;
        }
        .ana-label { font-size: 0.7rem; color: #888; text-transform: uppercase; letter-spacing: 1px; }
        .ana-val { display: block; font-size: 1.4rem; font-weight: 900; margin-top: 5px; }
        .progress-bar { 
            position: absolute; bottom: 0; left: 0; height: 3px; background: var(--green); 
            transition: width 0.5s;
        }

        /* –ó–∞–∫–∞–∑—ã */
        .search-box { margin-bottom: 20px; position: relative; }
        .card { 
            background: var(--card); border: 1px solid var(--border); 
            padding: 20px; border-radius: 14px; margin-bottom: 15px; 
            position: relative; transition: 0.3s;
        }
        .card:active { transform: scale(0.98); }
        .price-tag { 
            float: right; color: var(--gold); font-weight: 900; 
            background: rgba(255, 215, 0, 0.1); padding: 4px 10px; 
            border-radius: 6px; border: 1px solid var(--gold);
        }

        /* –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é */
        .nav { 
            position: fixed; bottom: 0; width: 100%; background: #050505; 
            border-top: 1px solid var(--border); display: flex; 
            justify-content: space-around; padding: 15px 0; z-index: 1000;
        }
        .nav-item { 
            background: none; border: none; color: #555; font-size: 0.7rem; 
            display: flex; flex-direction: column; align-items: center; gap: 6px;
        }
        .nav-item.active { color: #fff; font-weight: bold; }

        /* –ë–µ–π–¥–∂–∏ –†–∞–Ω–≥–æ–≤ */
        .badge { font-size: 0.6rem; padding: 3px 8px; border-radius: 5px; font-weight: bold; margin-left: 8px; }
        .b-jun { background: #333; color: #aaa; }
        .b-mid { background: var(--blue); color: #fff; }
        .b-sen { background: var(--purple); color: #fff; box-shadow: 0 0 10px var(--purple); }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        #toast { 
            position: fixed; top: 30px; left: 50%; transform: translateX(-50%); 
            background: #fff; color: #000; padding: 14px 28px; 
            border-radius: 50px; font-weight: 900; display: none; 
            z-index: 10000; box-shadow: 0 10px 30px rgba(0,0,0,0.8);
        }
    </style>
</head>
<body>

    <div id="toast"></div>

    <div id="login-view" class="auth-container">
        <div class="auth-card">
            <h1 style="letter-spacing: 8px; margin: 0;">S.A.B.</h1>
            <p style="color: #444; font-size: 0.7rem; margin-bottom: 30px;">BOSS EDITION v11.0</p>
            <input type="text" id="l-phone" placeholder="705163333">
            <input type="password" id="l-pass" placeholder="–ü–∞—Ä–æ–ª—å">
            <button class="btn-main" onclick="onLogin()">–í–û–ô–¢–ò –í –°–ò–°–¢–ï–ú–£</button>
            <button class="btn-sec" onclick="toggleReg(true)">–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</button>
            <p onclick="resetSystem()" style="color:#222; font-size:0.6rem; margin-top:20px; cursor:pointer;">–ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö</p>
        </div>
    </div>

    <div id="reg-view" class="auth-container" style="display:none;">
        <div class="auth-card">
            <h2>–°–û–¢–†–£–î–ù–ò–ö</h2>
            <input type="text" id="r-name" placeholder="–í–∞—à–µ –ò–º—è">
            <input type="text" id="r-phone" placeholder="–í–∞—à –ù–æ–º–µ—Ä">
            <input type="password" id="r-pass" placeholder="–ü–∞—Ä–æ–ª—å">
            <button class="btn-main" onclick="onReg()">–°–û–ó–î–ê–¢–¨ ID</button>
            <button class="btn-sec" onclick="toggleReg(false)">–ù–ê–ó–ê–î</button>
        </div>
    </div>

    <div id="app">
        <div class="header">
            <div>
                <b id="me-name">Akjol</b> <br>
                <small id="me-role" style="color:var(--green); text-transform:uppercase;"></small>
            </div>
            <button onclick="location.reload()" style="width:auto; padding:8px 15px; background:none; border:1px solid #333; color:#555; font-size:0.7rem;">–í–´–•–û–î</button>
        </div>

        <div class="content" id="main-scroll">
            </div>

        <div class="nav">
            <button class="nav-item active" id="btn-orders" onclick="go('orders')">üìä –ó–ê–ö–ê–ó–´</button>
            <button class="nav-item" id="btn-add" onclick="go('add')">üî• –°–û–ó–î–ê–¢–¨</button>
            <button class="nav-item" id="btn-team" onclick="go('team')">üõ°Ô∏è –ö–û–ú–ê–ù–î–ê</button>
            <button class="nav-item" id="btn-money" onclick="go('money')">üí∞ –ö–ê–°–°–ê</button>
        </div>
    </div>

    <script>
        /* --- –°–ï–†–î–¶–ï –°–ò–°–¢–ï–ú–´ (JS) --- */

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        let SAB_DB = JSON.parse(localStorage.getItem('sab_v11_db')) || {
            users: [
                { name: "–°–æ–ª—Ç–æ", phone: "700000000", pass: "1234", role: "manager", xp: 5, joined: "2026-01-20" }
            ],
            orders: [],
            logs: []
        };

        let activeUser = null;
        let activeTab = 'orders';

        // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
        function onLogin() {
            const ph = document.getElementById('l-phone').value.trim();
            const ps = document.getElementById('l-pass').value.trim();

            if (ph === '705163333' && ps === 'admin123') {
                activeUser = { name: "–ê–∫–∂–æ–ª", phone: "705163333", role: "director", xp: 999 };
                startApp();
            } else {
                let u = SAB_DB.users.find(x => x.phone === ph && x.pass === ps);
                if (u) { activeUser = u; startApp(); } 
                else { showMsg('–û–®–ò–ë–ö–ê –î–û–°–¢–£–ü–ê'); }
            }
        }

        function onReg() {
            const n = document.getElementById('r-name').value;
            const p = document.getElementById('r-phone').value;
            const ps = document.getElementById('r-pass').value;

            if(!n || !p || !ps) return showMsg('–ó–ê–ü–û–õ–ù–ò–¢–ï –í–°–Å');
            if(SAB_DB.users.find(x => x.phone === p) || p === '705163333') return showMsg('–ù–û–ú–ï–† –ó–ê–ù–Ø–¢');

            SAB_DB.users.push({ name: n, phone: p, pass: ps, role: "programmer", xp: 0, joined: new Date().toISOString().split('T')[0] });
            save();
            showMsg('ID –°–û–ó–î–ê–ù!');
            setTimeout(() => location.reload(), 1000);
        }

        function startApp() {
            document.getElementById('login-view').style.display = 'none';
            document.getElementById('app').style.display = 'flex';
            document.getElementById('me-name').innerText = activeUser.name;
            document.getElementById('me-role').innerText = activeUser.role;
            go('orders');
        }

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è
        function go(tab) {
            activeTab = tab;
            const container = document.getElementById('main-scroll');
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            document.getElementById('btn-' + tab).classList.add('active');

            if(tab === 'orders') renderOrders();
            if(tab === 'add') renderAdd();
            if(tab === 'team') renderTeam();
            if(tab === 'money') renderMoney();
        }

        // –í–∏–¥: –ó–ê–ö–ê–ó–´
        function renderOrders() {
            const container = document.getElementById('main-scroll');
            const workCount = SAB_DB.orders.filter(o => o.status === 'work').length;
            const freeCount = SAB_DB.orders.filter(o => o.status === 'new').length;

            container.innerHTML = `
                <div class="analytics">
                    <div class="ana-card">
                        <span class="ana-label">–í –†–ê–ë–û–¢–ï</span>
                        <span class="ana-val">${workCount}</span>
                        <div class="progress-bar" style="width: ${workCount * 10}%"></div>
                    </div>
                    <div class="ana-card">
                        <span class="ana-label">–°–í–û–ë–û–î–ù–û</span>
                        <span class="ana-val">${freeCount}</span>
                        <div class="progress-bar" style="width: ${freeCount * 10}%; background: var(--blue)"></div>
                    </div>
                </div>
                <h3>–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã</h3>
            `;

            let list = SAB_DB.orders.filter(o => o.status !== 'archive').reverse();
            if(list.length === 0) container.innerHTML += '<p style="color:#222; text-align:center; margin-top:50px;">–ó–∞–∫–∞–∑–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç...</p>';

            list.forEach((o, i) => {
                let realIdx = SAB_DB.orders.indexOf(o);
                container.innerHTML += `
                    <div class="card">
                        <span class="price-tag">${o.price} c</span>
                        <b>${o.client}</b>
                        <p style="font-size:0.85rem; color:#888; margin:10px 0;">${o.desc}</p>
                        <div style="font-size:0.7rem; color:#444;">–î–ï–î–õ–ê–ô–ù: ${o.date} | ${o.status.toUpperCase()}</div>
                        <div style="margin-top:15px; display:flex; gap:10px;">
                            ${o.status === 'new' ? `<button onclick="updateSt(${realIdx}, 'work')" style="background:var(--green); color:#000;">–í–ó–Ø–¢–¨ –í –†–ê–ë–û–¢–£</button>` : ''}
                            ${o.status === 'work' ? `<button onclick="updateSt(${realIdx}, 'done')" style="background:var(--gold); color:#000;">–ó–ê–í–ï–†–®–ò–¢–¨</button>` : ''}
                            ${['director', 'manager'].includes(activeUser.role) ? `<button onclick="updateSt(${realIdx}, 'archive')" style="background:none; border:1px solid var(--red); color:var(--red); width:auto; padding:5px 15px;">X</button>` : ''}
                        </div>
                    </div>
                `;
            });
        }

        // –í–∏–¥: –î–û–ë–ê–í–ò–¢–¨
        function renderAdd() {
            if(activeUser.role === 'programmer') {
                return document.getElementById('main-scroll').innerHTML = '<h2 style="text-align:center; margin-top:100px; color:#333;">–î–û–°–¢–£–ü –ó–ê–ü–†–ï–©–ï–ù</h2>';
            }
            document.getElementById('main-scroll').innerHTML = `
                <h3>–ù–æ–≤–æ–µ –¢–µ—Ö–∑–∞–¥–∞–Ω–∏–µ</h3>
                <input id="in-client" placeholder="–ò–º—è –∑–∞–∫–∞–∑—á–∏–∫–∞ / –ù–∞–∑–≤–∞–Ω–∏–µ">
                <input id="in-price" type="number" placeholder="–ë—é–¥–∂–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞ (—Å–æ–º)">
                <textarea id="in-desc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ (—Å—Å—ã–ª–∫–∏, –¢–ó, —Ä–µ—Ñ–µ—Ä–µ–Ω—Å—ã)" style="height:150px;"></textarea>
                <input id="in-date" type="date">
                <button class="btn-main" onclick="createOrder()">–û–ü–£–ë–õ–ò–ö–û–í–ê–¢–¨ –ó–ê–ö–ê–ó</button>
            `;
        }

        function createOrder() {
            const c = document.getElementById('in-client').value;
            const p = document.getElementById('in-price').value;
            const d = document.getElementById('in-desc').value;
            const dt = document.getElementById('in-date').value;

            if(!c || !p || !dt) return showMsg('–ó–ê–ü–û–õ–ù–ò–¢–ï –ü–û–õ–Ø');

            SAB_DB.orders.push({ client: c, price: p, desc: d, date: dt, status: 'new', created: new Date().toISOString() });
            save();
            showMsg('–ó–ê–ö–ê–ó –°–û–ó–î–ê–ù!');
            go('orders');
        }

        // –í–∏–¥: –ö–û–ú–ê–ù–î–ê
        function renderTeam() {
            const container = document.getElementById('main-scroll');
            container.innerHTML = '<h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–¥—Ä–∞–º–∏</h3>';

            let all = [...SAB_DB.users];
            all.forEach(u => {
                let rank = u.xp >= 10 ? 'sen' : (u.xp >= 3 ? 'mid' : 'jun');
                let badgeClass = 'b-' + rank;
                let badgeName = rank.toUpperCase();

                container.innerHTML += `
                    <div class="card" style="display:flex; justify-content:space-between; align-items:center;">
                        <div>
                            <b>${u.name}</b> <span class="badge ${badgeClass}">${badgeName}</span> <br>
                            <small style="color:#555;">${u.role.toUpperCase()} | XP: ${u.xp}</small>
                        </div>
                        ${activeUser.role === 'director' && u.phone !== '705163333' ? `
                            <div style="display:flex; gap:5px;">
                                <button onclick="promote('${u.phone}', 'up')" style="width:40px; background:var(--green); color:#000;">‚Üë</button>
                                <button onclick="promote('${u.phone}', 'down')" style="width:40px; background:var(--gold); color:#000;">‚Üì</button>
                                <button onclick="fire('${u.phone}')" style="width:40px; background:var(--red); color:#fff;">X</button>
                            </div>
                        ` : ''}
                    </div>
                `;
            });
        }

        function promote(ph, dir) {
            let u = SAB_DB.users.find(x => x.phone === ph);
            if(!u) return;
            const roles = ['programmer', 'manager', 'deputy'];
            let idx = roles.indexOf(u.role);
            
            if(dir === 'up' && idx < 2) u.role = roles[idx + 1];
            if(dir === 'down' && idx > 0) u.role = roles[idx - 1];

            save();
            renderTeam();
            showMsg('–°–¢–ê–¢–£–° –û–ë–ù–û–í–õ–ï–ù');
        }

        // –í–∏–¥: –ö–ê–°–°–ê
        function renderMoney() {
            const container = document.getElementById('main-scroll');
            const total = SAB_DB.orders.filter(o => o.status === 'done').reduce((a, b) => a + Number(b.price), 0);
            const pending = SAB_DB.orders.filter(o => o.status === 'work').reduce((a, b) => a + Number(b.price), 0);

            container.innerHTML = `
                <div class="analytics">
                    <div class="ana-card" style="border-color: var(--gold)">
                        <span class="ana-label">–ß–ò–°–¢–ê–Ø –ü–†–ò–ë–´–õ–¨</span>
                        <span class="ana-val" style="color: var(--gold)">${total} —Å</span>
                    </div>
                    <div class="ana-card">
                        <span class="ana-label">–í –û–ñ–ò–î–ê–ù–ò–ò</span>
                        <span class="ana-val">${pending} —Å</span>
                    </div>
                </div>
                <h3>–ò—Å—Ç–æ—Ä–∏—è –≤—ã–ø–ª–∞—Ç</h3>
                <p style="color:#222; font-size:0.8rem;">–ó–¥–µ—Å—å –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –ø–ª–∞—Ç–µ–∂–µ–π.</p>
            `;
        }

        // –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function updateSt(i, st) {
            SAB_DB.orders[i].status = st;
            if(st === 'done') {
                // –ù–∞—á–∏—Å–ª—è–µ–º XP —Ç–æ–º—É –∫—Ç–æ –≤–∑—è–ª? (–£–ø—Ä–æ—â–µ–Ω–Ω–æ: –∞–∫—Ç–∏–≤–Ω–æ–º—É —é–∑–µ—Ä—É)
                activeUser.xp += 1;
                let u = SAB_DB.users.find(x => x.phone === activeUser.phone);
                if(u) u.xp += 1;
            }
            save();
            renderOrders();
            showMsg('–û–ë–ù–û–í–õ–ï–ù–û');
        }

        function save() { localStorage.setItem('sab_v11_db', JSON.stringify(SAB_DB)); }
        
        function showMsg(m) {
            const t = document.getElementById('toast');
            t.innerText = m; t.style.display = 'block';
            setTimeout(() => t.style.display = 'none', 2500);
        }

        function fire(ph) {
            if(confirm('–£–≤–æ–ª–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–∞–≤—Å–µ–≥–¥–∞?')) {
                SAB_DB.users = SAB_DB.users.filter(x => x.phone !== ph);
                save(); renderTeam();
            }
        }

        function toggleReg(s) {
            document.getElementById('login-view').style.display = s ? 'none' : 'flex';
            document.getElementById('reg-view').style.display = s ? 'flex' : 'none';
        }

        function resetSystem() {
            if(confirm('–í–ù–ò–ú–ê–ù–ò–ï: –≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏ –≤—Å–µ –∑–∞–∫–∞–∑—ã. –í—ã —É–≤–µ—Ä–µ–Ω—ã?')) {
                localStorage.clear();
                location.reload();
            }
        }

    </script>
</body>
</html>
